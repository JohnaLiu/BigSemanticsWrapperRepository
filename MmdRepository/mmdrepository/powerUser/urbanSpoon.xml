<?xml version="1.0" encoding="UTF-8"?>
<meta_metadata_repository name="urbanSpoon"
	package="ecologylab.semantics.generated.library.urbanspoon">
	
	<meta_metadata name="urban_spoon_restaurant" type="restaurant"
		parser="xpath" comment="UrbanSpoon restaurant description page" user_agent_string="firefox">
		
		<selector url_path_tree="http://www.urbanspoon.com/r/" />
		
		<example_url url="http://www.urbanspoon.com/r/114/875031/restaurant/College-Station/Christophers-World-Grill-Bryan" />
		
		<def_var name="main_block" type="node" xpath="//div[@id='directory']" />
		<def_var name="primary" type="node" xpath="//div[@id='primary']" />
		
		<scalar name="title" context_node="main_block" xpath="./div/h1"/>
		<scalar name="link" context_node="primary" xpath="./p[@class='website']/a[@class='ext']/@href" />
		<scalar name="rating" xpath="//div[@id='vote_block']/div[@class='score up']/div[@class='number']/span[@class='digits percent-text rating average']" />
		<scalar name="price_range" xpath="//div[@id='secondary']/div[@class='menu']/fieldset/div[@class='price']/span[@class='pricerange']" />

		
		<composite name="image" >
			<scalar name="location" xpath="//div[@id='aside']//ul[contains(@id,'_collection')]/li[contains(@id,'restaurant_photo')][1]//img/@srcd" />
		</composite>
		
		<composite name="place" xpath="//div[@id='primary']">
			<scalar name="location" xpath="./div[@class='address adr']/a[1]/@href" />
			<scalar name="telephone" xpath="./h3" />
			<scalar name="street_address" xpath=".//span[@class='street-address']" />
			<scalar name="locality" xpath=".//span[@class='locality']" />
			<scalar name="postal_code" xpath=".//a[@class='postal-code']" />
			<scalar name="region" xpath=".//span[@class='region']" />
		</composite>
		
		<collection name="genres" xpath="//div[@id='secondary']/div[@class='cuisines']/fieldset/a">
			<scalar name="title" xpath="./text()" />
			<scalar name="location" xpath="./@href" />
		</collection>
	</meta_metadata>

	<meta_metadata name="urban_spoon_genre" extends="search" comment="UrbanSpoon Search Class"  parser="xpath">
		<selector name="spoon1" url_path_tree="http://www.urbanspoon.com/f/"/>
		<collection name="search_results" xpath="//div[@class = 't']/a[text() != '']" child_type="search_result">
			<scalar name="location" xpath="./@href" />
			<scalar name="title" xpath="./text()" />
		</collection>
		<collection name="top_results" xpath="//div[@id='callout']/ol/li/a" child_type="search_result">
			<scalar name="location" xpath="./@href" />
			<scalar name="title" xpath="./text()" />
		</collection>
		<semantic_actions>
			<get_field name="top_results" />
			<for_each collection="top_results" as="res">
				<get_field object="res" name="location" />
				<get_field object="res" name="title" />
				<parse_document>
					<arg value="title" name="anchor_text" />
					<arg value="location" name="location" />
				</parse_document>
			</for_each>
		</semantic_actions>
	</meta_metadata>
	
	<meta_metadata name="urban_spoon_search" comment="UrbanSpoon Search Class" type="search" parser="xpath">
		<selector name="spoon1" url_path_tree="http://www.urbanspoon.com/s/"/>
		<collection name="search_results" xpath="//div[@class = 't']/a[text() != '']" child_type="search_result">
			<scalar name="title" xpath="./text()" />
			<scalar name="location" xpath="./@href" />
		</collection>
		<semantic_actions>
			<get_field name="search_results" />
			<for_each collection="search_results" as="res">
				<get_field object="res" name="location" />
				<get_field object="res" name="title" />
				<parse_document>
					<arg value="title" name="anchor_text" />
					<arg value="location" name="location" />
				</parse_document>
			</for_each>
		</semantic_actions>
	</meta_metadata>

</meta_metadata_repository>