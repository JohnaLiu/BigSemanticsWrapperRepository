<meta_metadata_repository name="imdb" package="ecologylab.bigsemantics.generated.library.imdb" 
                          default_user_agent_name="chrome">
	
	<cookie_processing domain="imdb.com" ignore_all_cookies="true" />

	<meta_metadata name="imdb_movie" extends="movie" comment="A movie in IMDB." parser="xpath">
		<selector url_path_tree="http://www.imdb.com/title/" />
		
    <example_url url="http://www.imdb.com/title/tt0137523/" comment="Fight club." />
    <example_url url="http://www.imdb.com/title/tt0110912/" comment="Pulp fiction." />
    
		<scalar name="title" xpath="//h1[@class='header']" />
		<scalar name="description" xpath="//p[@itemprop='description']">
			<filter regex="more" replace="" />
		</scalar>
		
    <scalar name="year" xpath="//h1[@class='header']/a" />
    <scalar name="mpaa_rating" xpath="//span[@itemprop='contentRating' and @title]/@title" />
    <scalar name="overall_rating" xpath="//span[@itemprop='ratingValue']" />
    <scalar name="storyline" xpath="//div[@itemprop='description']" />
    <scalar name="tagline" xpath="//h4[contains(.,'Tagline')]/..">
      <filter regex="Taglines:|See more" replace="" />
    </scalar>
    <scalar name="runtime" xpath="//time[@itemprop='duration']" />
    <scalar name="theater_release" xpath="//h4[contains(.,'Release Date:')]/..">
      <filter regex="Release Date:|See more" replace="" />
    </scalar>
   
    <scalar name="pic" xpath="//td[@id='img_primary']//img/@src" hide="true" layer="3.0" />
    <collection name="photos" hide="true" xpath="//div[@class='mediastrip']//img">
      <scalar name="location" xpath="./@src" />
    </collection>
                
		<collection name="directors" child_type="imdb_person" xpath="//h4[contains(.,'Director')]/../a[@itemprop]">
			<scalar name="location" hide="true" xpath="./@href" />
			<scalar name="title" xpath="." label="name" />	
		</collection>
		<collection name="writers" child_type="imdb_person" xpath="//h4[contains(.,'Writer')]/../a[@itemprop]">
			<scalar name="location" hide="true" xpath="./@href" />
			<scalar name="title" xpath="." label="name" />	
		</collection>
		<collection name="cast" child_type="imdb_person" layer="8.0" xpath="//table[@class='cast_list']//tr[@class]">
      <scalar name="title" xpath=".//*[@itemprop='actor']/*[@itemprop='url']" />
      <scalar name="location" xpath=".//*[@itemprop='actor']/*[@itemprop='url']/@href" />
      <composite name="photo" xpath="./td[@class='primary_photo']">
        <scalar name="location" xpath=".//img/@src" />
      </composite>
		</collection>
		<collection name="genres" xpath="//h4[contains(.,'Genres:')]/../a">
			<scalar name="title" xpath="." />
			<scalar name="location" hide="false" xpath="./@href" />
		</collection>

		<semantic_actions>
			<get_field name="pic"/> 
			<create_and_visualize_img_surrogate> 
				<arg value="pic" name="image_purl"/> 
			</create_and_visualize_img_surrogate> 
		</semantic_actions>
	</meta_metadata>
  
  
  <meta_metadata name="imdb_person" extends="movie_person" parser="xpath">
    <selector url_path_tree="http://www.imdb.com/name/" />
    <example_url url="http://www.imdb.com/name/nm0000487/" />
    <example_url url="http://www.imdb.com/name/nm0000199/" />
    <example_url url="http://www.imdb.com/name/nm0004266/" />
    <filter_location>
      <strip_param name="ref_" />
    </filter_location>
   
    <scalar name="title" xpath="//*[@itemprop='name']" />
    <scalar name="description" xpath="//*[@itemprop='description']" />
    
    <composite name="birth_detail">
      <scalar name="birth_date" xpath="//*[@itemprop='birthDate']/@datetime" />
      <scalar name="birth_place" xpath="//*[@itemprop='birthDate']/following-sibling::a" />
    </composite>
    
    <collection name="movies_directed" xpath="//div[@id='filmography']//div[@id='filmo-head-Director']/following-sibling::div[1]//div[contains(@class, 'filmo-row')]">
      <scalar name="title" xpath=".//a" />
      <scalar name="location" xpath=".//a/@href" />
    </collection>
    <collection name="movies_written" xpath="//div[@id='filmography']//div[@id='filmo-head-Writer']/following-sibling::div[1]//div[contains(@class, 'filmo-row')]">
      <scalar name="title" xpath=".//a" />
      <scalar name="location" xpath=".//a/@href" />
    </collection>
    <collection name="movies_acted_in" xpath="//div[@id='filmography']//div[@id='filmo-head-Actor' or @id='filmo-head-Actress']/following-sibling::div[1]//div[contains(@class, 'filmo-row')]">
      <scalar name="title" xpath=".//a" />
      <scalar name="location" xpath=".//a/@href" />
    </collection>
  </meta_metadata>

</meta_metadata_repository>